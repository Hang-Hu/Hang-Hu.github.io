<h2 id="dependency">Dependency</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
    &lt;version&gt;5.3.4.Final&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</div>

<h2 id="first-edition">First Edition</h2>

<p>Controller</p>

<p>In this edition, 400 will be sent back if validation fails, and method won’t be executed.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Controller
public class WeekController {
	@RequestMapping("/weeks")
	@ResponseBody public WeekDTO getWeekList(@Valid @RequestBody User user){
		System.out.println("weeks here.");
		System.out.println(user.getId()+" "+user.getName()+" "+user.getAge());
		return new WeekDTO();
	}
}
</code></pre>
</div>

<p>Class User</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public class User {
    @NotNull
    private Integer id;
    @NotNull
    private String name;
    @NotNull
    //@Min(18)
    @Range(min=18)
    private Integer age;
    public Integer getId() {
        return id;
    }
    public void setId(Integer id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public Integer getAge() {
        return age;
    }
    public void setAge(Integer age) {
        this.age = age;
    }
}
</code></pre>
</div>

<h2 id="second-edition">Second Edition</h2>

<p>In this edition, if validations fails, 400 won’t be sent back as response, and method will be executed, what will be sent back depends on code in method. Error handling can be done within <code class="highlighter-rouge">if(bindingResult.hasErrors()){}</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Controller
public class WeekController {
	//getWeekList
	@RequestMapping("/weeks")
	@ResponseBody public WeekDTO getWeekList(@Valid @RequestBody User user, BindingResult bindingResult){
		if(bindingResult.hasErrors())
			System.out.println("errors in binding");
		System.out.println("weeks here.");
		System.out.println(user.getId()+" "+user.getName()+" "+user.getAge());
		return new WeekDTO();
	}
}
</code></pre>
</div>

<h2 id="third-edition">Third Edition</h2>

<p>Handling errors in every controller is code duplication. Therefore, handle it in exception is a good idea. When the validation fails, <code class="highlighter-rouge">@Valid</code> throws a <code class="highlighter-rouge">MethodArgumentNotValidException</code>, then what to do is to write an <code class="highlighter-rouge">ExceptionHandler</code> for this specific exception. This time the method won’t be executed and a custom Json response will back using <code class="highlighter-rouge">ResponseEntity</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>@Controller
public class WeekController {
	//getWeekList
	@RequestMapping("/weeks")
	@ResponseBody public WeekDTO getWeekList(@Valid @RequestBody User user){
		System.out.println("weeks here.");
		System.out.println(user.getId()+" "+user.getName()+" "+user.getAge());
		return new WeekDTO();
	}
	@ExceptionHandler(MethodArgumentNotValidException.class)
	@ResponseBody
	public ResponseEntity&lt;String&gt; handleValidationException(MethodArgumentNotValidException e) {
        List&lt;ObjectError&gt; objectErrors = e.getBindingResult().getAllErrors();
        List&lt;ErrorDTO&gt; errorDTOs = new LinkedList&lt;&gt;();
        for (Iterator i = objectErrors.listIterator(); i.hasNext(); ) {
            ObjectError objectError = (ObjectError) i.next();
            ErrorDTO errorDTO = new ErrorDTO();
            errorDTO.setObjectName(objectError.getObjectName());
            errorDTO.setMessage(objectError.getDefaultMessage());
            errorDTOs.add(errorDTO);
        }
        return new ResponseEntity&lt;String&gt;(errorDTOs.toString(), HttpStatus.BAD_REQUEST);
    }
}
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>public class ErrorDTO {
    private String objectName;
    private String message;
    public String getObjectName() {
        return objectName;
    }
    public void setObjectName(String objectName) {
        this.objectName = objectName;
    }
    public String getMessage() {
        return message;
    }
    public void setMessage(String message) {
        this.message = message;
    }
    @Override
    public String toString() {
        String json=null;
        try {
            json=new ObjectMapper().writeValueAsString(this);
        } catch (JsonProcessingException e) {
            e.printStackTrace();
        }
        return json;
    }
}
</code></pre>
</div>
