<h2 id="detail">Detail</h2>

<p>Caused by: java.lang.IllegalArgumentException: ROLE_ADMIN cannot start with ROLE_ (it is automatically added)</p>
<h2 id="reason">Reason</h2>

<p><code class="highlighter-rouge">ROLE_</code> will be automatically added to inMemoryAuthentication’s roles. However, roles in <code class="highlighter-rouge">.antMatchers("/user/**").access("hasRole('ROLE_USER')")</code> or database won’t be added with prefix <code class="highlighter-rouge">ROLE_</code>, so you add it manually.</p>
<h2 id="solution">Solution</h2>

<p>Change:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>authenticationManagerBuilder.inMemoryAuthentication().withUser("bill").password("123")
.roles("ROLE_ADMIN");
</code></pre>
</div>

<p>To:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>authenticationManagerBuilder.inMemoryAuthentication().withUser("bill").password("123")
.roles("ADMIN");
</code></pre>
</div>
